# Документ с баг-репортами для API микросервиса объявлений

Ниже приведены выявленные дефекты в работе API. Каждый баг описан с уникальным идентификатором, приоритетом, перечнем связанных тест-кейсов, подробным описанием, пошаговыми инструкциями для воспроизведения, ожидаемым результатом и фактическим поведением, зафиксированным в автоматизированных тестах (см. файл test_api.py).

> **Примечание:** Некоторые баги помечены как "Known bug" и сопровождаются метками xfail в тестах. Дополнительная информация о них содержится в этом документе.

---

## Bug ID: API_BUG_001
**Приоритет:** Высокий  
**Связанные тест-кейсы:** API_TC_001, API_TC_002, API_TC_003, API_TC_010

**Описание:**  
При выполнении GET-запроса для получения объявления значение поля `name` возвращается с некорректным содержимым (например, "dsds" вместо "iPhone XR").

**Шаги воспроизведения:**
1. Создать объявление через POST-запрос на `/api/1/item` с полем `name` равным "iPhone XR".
2. Извлечь идентификатор из ответа (из строки вида "Announcement saved - \<item_id\>").
3. Отправить GET-запрос по адресу `/api/1/item/{item_id}`.
4. Сравнить значение поля `name` с ожидаемым.

**Ожидаемый результат:**  
Поле `name` должно содержать значение "iPhone XR".

**Фактический результат:**  
Поле `name` имеет значение "dsds".  
Тест помечен как xfail с сообщением:  
"Known bug API_BUG_001: 'name' field does not match expected value"

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura  
- Инструменты: pytest + requests, Postman

---

## Bug ID: API_BUG_002
**Приоритет:** Высокий  
**Связанные тест-кейсы:** API_TC_004

**Описание:**  
При отсутствии обязательных полей (например, `sellerId`, `name`, `price` или `statistics`) в POST-запросе API возвращает статус 200 OK вместо 400 Bad Request.

**Шаги воспроизведения:**
1. Отправить POST-запрос на `/api/1/item` с удалённым полем (например, `name`).
2. Проверить статус ответа и наличие сообщения об ошибке.

**Ожидаемый результат:**  
Сервер должен возвращать статус 400 Bad Request с описанием отсутствующего поля.

**Фактический результат:**  
Сервер возвращает статус 200 OK, что позволяет создавать объявления с отсутствующими обязательными данными.  
Тесты помечены как xfail с сообщением:  
"Known bug API_BUG_002/003/004: API returns 200 OK when '<поле>' is missing"

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura

---

## Bug ID: API_BUG_003
**Приоритет:** Высокий  
**Связанные тест-кейсы:** API_TC_009

**Описание:**  
При отправке POST-запроса с пустым телом (пустой JSON-объект `{}`) API возвращает статус 200 OK, вместо ожидаемого 400 Bad Request.

**Шаги воспроизведения:**
1. Отправить POST-запрос по адресу `/api/1/item` с телом: `{}`.
2. Проверить статус ответа.

**Ожидаемый результат:**  
Статус ответа должен быть 400 Bad Request с сообщением об ошибке, указывающим на отсутствие данных.

**Фактический результат:**  
Сервер возвращает статус 200 OK.  
Тест помечен как xfail с сообщением:  
"Known bug API_BUG_003: API returns 200 OK when body is empty"

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura

---

## Bug ID: API_BUG_004
**Приоритет:** Высокий  
**Связанные тест-кейсы:** API_TC_005, API_TC_006, API_TC_007, API_TC_008

**Описание:**  
API не отклоняет запросы с некорректными значениями обязательных полей. При передаче:
- `sellerId` с отрицательным значением или чрезмерно большим числом,
- `name` заданным как строка, состоящая только из цифр или пробелов,
- `price` равным отрицательному значению, 0 или строкой,
- `statistics` с неверным форматом (null, отрицательными значениями или строковыми значениями)  
возвращается статус 200 OK, что нарушает логику валидации.

**Шаги воспроизведения:**
1. Отправить POST-запрос с `sellerId` равным -1 и с чрезмерно большим числом.
2. Отправить POST-запрос с `name` состоящим только из цифр.
3. Отправить POST-запрос с `price` равным -1500 или "1500".
4. Отправить POST-запрос, где `statistics` задан как null или содержит отрицательные значения.
5. Проверить статус ответа для каждого запроса.

**Ожидаемый результат:**  
Для каждого варианта сервер должен вернуть статус 400 Bad Request с описанием ошибки.

**Фактический результат:**  
Для большинства таких сценариев сервер возвращает статус 200 OK.  
Тесты для подобных случаев помечены как xfail с сообщением:  
"Known bug API_BUG_004: API returns 200 OK for invalid field values"

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura

---

## Bug ID: API_BUG_006
**Приоритет:** Высокий  
**Связанные тест-кейсы:** API_TC_012

**Описание:**  
При выполнении GET-запроса для получения статистики объявления (по адресу `/api/1/statistic/{id}`) значение поля `likes` не соответствует значению, переданному в POST-запросе.

**Шаги воспроизведения:**
1. Создать объявление через POST-запрос с определённым значением в `statistics.likes` (например, 12).
2. Извлечь идентификатор объявления.
3. Отправить GET-запрос на `/api/1/statistic/{id}`.
4. Сравнить значение поля `likes` с исходным.

**Ожидаемый результат:**  
Значение `likes` должно быть равно 12 (или тому значению, которое было передано).

**Фактический результат:**  
Возвращается значение, отличное от ожидаемого (например, другое число).  
Тест помечен как xfail с сообщением:  
"Known bug API_BUG_006: 'likes' value in statistic does not match expected"

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura

---

## Bug ID: API_BUG_007
**Приоритет:** Средний  
**Связанные тест-кейсы:** API_TC_014

**Описание:**  
При выполнении GET-запроса для получения списка объявлений продавца по адресу `/api/1/{sellerId}/item` ответ приходит в виде словаря вместо ожидаемого массива. Кроме того, некоторые поля (например, `createdAt`, `id`, `name`) содержат некорректные значения.

**Шаги воспроизведения:**
1. Создать одно или несколько объявлений для заданного `sellerId`.
2. Отправить GET-запрос по адресу `/api/1/{sellerId}/item`.
3. Проверить формат возвращаемых данных и содержимое основных полей.

**Ожидаемый результат:**  
Ответ должен быть представлен в виде массива (list) с корректными данными для каждого объявления (например, `createdAt` в формате ISO 8601, правильное значение `id` и `name`).

**Фактический результат:**  
Ответ иногда приходит в виде словаря, а содержимое полей не соответствует ожидаемому.  
Тест помечен как xfail с сообщением:  
"Known bug API_BUG_007: Response format for seller items is incorrect"

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura

---

## Bug ID: API_BUG_008
**Приоритет:** Средний  
**Связанные тест-кейсы:** API_TC_015

**Описание:**  
При отправке GET-запроса для получения списка объявлений по `sellerId` с недопустимыми значениями (например, значение меньше минимально допустимого или больше максимально допустимого, либо строка с недопустимыми символами) API возвращает статус 200 OK вместо 400 Bad Request.

**Шаги воспроизведения:**
1. Отправить GET-запрос по адресу `/api/1/{sellerId}/item` с недопустимым значением, например:
   - `sellerId` = 1000000 (больше допустимого)
   - `sellerId` = 111110 (меньше допустимого)
   - `sellerId` = "invalidSeller"
2. Проверить статус ответа.

**Ожидаемый результат:**  
Сервер должен вернуть статус 400 Bad Request с сообщением об ошибке, связанным с некорректным значением `sellerId`.

**Фактический результат:**  
В некоторых случаях сервер возвращает статус 200 OK, что противоречит ожиданиям.

**Окружение:**  
- API Base URL: https://qa-internship.avito.com  
- OS: MacOS 13 Ventura

---